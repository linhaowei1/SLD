{"id": "bd930d54-6656-438e-9be5-2053cefad58c", "code": "# EVOLVE-BLOCK-START\nimport numpy as np\n\ndef scaling_law_func(data_points, params):\n    \"\"\"\n    Predicts language model loss via a compact multiplicative power-law:\n      loss \u2248 exp(intercept + \u2211_{i} exponent_i * log(feature_i))\n    Features in data_points are [lr, bsz, data_size, non_embedding_param_size].\n    Params is a vector of length F+1 = 5: \n      [intercept, exp_lr, exp_bsz, exp_data_size, exp_param_size].\n    Returns an array of predicted losses (shape N,).\n    \"\"\"\n    X = np.atleast_2d(np.asarray(data_points, dtype=float))\n    # avoid log(0)\n    eps = 1e-12\n    X = np.clip(X, eps, None)\n    p = np.asarray(params, dtype=float).ravel()\n    F = X.shape[1]\n    if p.size != F + 1:\n        raise ValueError(f\"Expected {F+1} parameters, got {p.size}\")\n    intercept = p[0]\n    exponents = p[1:]\n    # compute in log-space for numerical stability\n    log_X = np.log(X)\n    log_y = intercept + log_X.dot(exponents)\n    return np.exp(log_y)\n\ndef fit_scaling_law(data_points, loss_values):\n    \"\"\"\n    Fits the power-law model:\n      log(loss) = intercept + \u2211_{i} exponent_i * log(feature_i)\n    by ordinary least squares in log-space. Returns params of length 5.\n    \"\"\"\n    X = np.atleast_2d(np.asarray(data_points, dtype=float))\n    y = np.asarray(loss_values, dtype=float).ravel()\n    # clamp to avoid log(0)\n    eps = 1e-12\n    X = np.clip(X, eps, None)\n    y = np.clip(y, eps, None)\n    # log-transform\n    Z = np.log(X)           # (N, F)\n    y_log = np.log(y)       # (N,)\n    N, F = Z.shape\n    # build design matrix [1, log(lr), log(bsz), log(data), log(params)]\n    M = np.hstack([np.ones((N, 1)), Z])  # (N, F+1)\n    # solve least-squares: M @ w \u2248 y_log\n    # w[0] = intercept, w[1:] = exponents\n    w, *_ = np.linalg.lstsq(M, y_log, rcond=None)\n    return w\n# EVOLVE-BLOCK-END", "language": "python", "parent_id": "eae09dba-1feb-473b-9275-23a937d6da51", "generation": 1, "timestamp": 1754802536.5395613, "iteration_found": 8, "metrics": {"nmse": 8.951042063054397, "nmae": 2.5693519223423507, "r2": -7.9510420630543965, "combined_score": 0.10049198804140695}, "complexity": 0.0, "diversity": 0.0, "metadata": {"island": 3}, "artifacts_json": null, "artifact_dir": null}